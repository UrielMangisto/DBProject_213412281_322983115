# שלב ד' - אינטגרציה ומבטי מערכת

## תוכן העניינים

1. [תרשימי DSD ו-ERD](#תרשימי-dsd-ו-erd)
2. [החלטות אינטגרציה](#החלטות-אינטגרציה)
3. [תהליך והפקודות](#תהליך-והפקודות)
4. [מבטי מערכת](#מבטי-מערכת)
5. [שאילתות לדוגמה](#שאילתות-לדוגמה)

## תרשימי DSD ו-ERD

### DSD של המידע שנכנס

![image](https://github.com/user-attachments/assets/54da6467-7867-4427-961f-e301381914c4)

### ERD של המידע הנכנס למערכת

![image](https://github.com/user-attachments/assets/e6fe032e-397d-4730-a8b7-f5e01f5d3b9b)

### DSD של המערכת שלנו

![image](https://github.com/user-attachments/assets/862a83bd-06b0-44ac-94ed-fb7659400dbf)

### ERD של המערכת שלנו

![image](https://github.com/user-attachments/assets/3010a972-cb92-48a5-a4f6-ececf2bb34a8)

## ניתוח DSD ו-ERD

1. **ניתוח ה-DSD**:
   התחלנו בניתוח ה-Data Structure Diagram (DSD) שהופק מקוד ה-PL/SQL. ה-DSD מציג את המבנה הלוגי של הנתונים כפי שהם מאורגנים בקוד, כולל טבלאות, עמודות, וקשרים בסיסיים.

2. **זיהוי ישויות**:
   מתוך ה-DSD, זיהינו את הישויות העיקריות במערכת. כל טבלה ב-DSD בדרך כלל מייצגת ישות ב-ERD. למשל, זיהינו ישויות כמו 'רופא', 'מטופל', 'ניתוח', 'תרופה' וכו'.

3. **הגדרת תכונות**:
   לכל ישות, הגדרנו את התכונות שלה בהתבסס על העמודות בטבלאות ה-DSD. למשל, עבור ישות 'מטופל', הגדרנו תכונות כמו מזהה, שם, תאריך לידה וכו'.

4. **זיהוי קשרים**:
   ניתחנו את הקשרים בין הטבלאות ב-DSD, בעיקר על ידי בחינת מפתחות זרים. זה עזר לנו להגדיר את הקשרים בין הישויות ב-ERD. למשל, הקשר בין 'רופא' ל'ניתוח'.

5. **הגדרת סוגי קשרים**:
   עבור כל קשר שזיהינו, הגדרנו את סוג הקשר (אחד לאחד, אחד לרבים, או רבים לרבים) ואת הקרדינליות שלו. זה נעשה על בסיס ההבנה שלנו את הדומיין והלוגיקה העסקית.

6. **טיפול בטבלאות קישור**:
   במקרים של קשרי רבים לרבים ב-DSD, יצרנו ישויות קישור ב-ERD. למשל, הטבלה 'Used_In' ב-DSD הפכה לישות קישור בין 'תרופה' ו'ניתוח' ב-ERD.

7. **זיהוי מפתחות ראשיים**:
   עבור כל ישות, זיהינו את המפתח הראשי בהתבסס על הגדרות ה-PRIMARY KEY ב-DSD.

8. **התאמות והרחבות**:
   לאחר יצירת ה-ERD הבסיסי, ביצענו התאמות נוספות בהתבסס על הבנתנו את צרכי המערכת. זה כלל הוספת ישויות או קשרים שאולי לא היו מפורשים ב-DSD.

9. **נרמול**:
   בחנו את המבנה שיצרנו כדי לוודא שהוא עומד בעקרונות הנרמול, ובמידת הצורך ביצענו שינויים כדי למנוע כפילויות ותלויות לא רצויות.

10. **תיעוד**:
    לבסוף, תיעדנו את ה-ERD באופן ויזואלי, כולל ישויות, תכונות, קשרים, וקרדינליות. זה יצר תמונה ברורה ומקיפה של מבנה הנתונים המתוכנן.

### סיכום

המעבר מ-DSD ל-ERD אפשר לנו לתרגם את המבנה הטכני של בסיס הנתונים למודל קונספטואלי יותר, המייצג את הישויות והקשרים בעולם האמיתי. תהליך זה היה חיוני להבנת המערכת ברמה גבוהה יותר ולתכנון אינטגרציה יעילה בין שתי המערכות.

## החלטות אינטגרציה

1. **מטרת האינטגרציה**:
   מטרת האינטגרציה הייתה לאחד את מערכת ניהול הניתוחים עם מערכת קביעת הפגישות, כדי ליצור מערכת מקיפה יותר לניהול מידע רפואי בבית החולים.

2. **שילוב טבלאות המטופלים (Patient1 ו-Patients)**:
   איחדנו את טבלאות המטופלים כדי ליצור מאגר מידע אחד ומקיף על כל המטופלים. הוספנו שדות חדשים כמו מגדר, פרטי קשר וביטוח, שהיו חסרים במערכת המקורית. זה מאפשר ניהול טוב יותר של פרטי המטופל ומשפר את היכולת לתקשר עמם ולנהל את הטיפול הרפואי שלהם.

3. **שילוב טבלאות הרופאים (Doctor1 ו-Doctors)**:
   איחוד טבלאות הרופאים מאפשר ניהול מרכזי של כל הרופאים בבית החולים, כולל אלה שמבצעים ניתוחים ואלה שעוסקים בטיפולים אחרים. הוספנו שדה לפרטי קשר, שמשפר את היכולת לתאם בין הצוותים השונים.

4. **הוספת טבלת Appointment1**:
   הוספנו טבלת פגישות חדשה שמאפשרת מעקב אחר כל הפגישות המתוכננות, כולל ניתוחים ובדיקות רגילות. זה מייעל את תהליך תזמון הפגישות ומאפשר ניצול טוב יותר של משאבי בית החולים.

5. **הוספת טבלת MedicalRecord1**:
   טבלת הרשומות הרפואיות החדשה מאפשרת שמירה מרוכזת של כל המידע הרפואי של המטופל, כולל אבחנות, טיפולים, תוצאות בדיקות ואלרגיות. זה מספק תמונה מקיפה יותר של ההיסטוריה הרפואית של כל מטופל.

6. **הוספת טבלאות Treatment1 ו-Billing1**:
   הוספנו טבלאות לניהול טיפולים וחיובים, שמשלימות את התמונה הכוללת של הטיפול במטופל. זה מאפשר מעקב אחר עלויות הטיפול ומצב התשלומים, ומשפר את היכולת לנהל את הפן הכלכלי של פעילות בית החולים.

7. **שינויים במבנה הנתונים**:
   ביצענו מספר שינויים במבנה הנתונים, כגון איחוד שדות השם הפרטי ושם המשפחה לשדה שם מלא אחד. זה נעשה כדי לפשט את מבנה הנתונים ולהתאים אותו לצורת השימוש הנפוצה יותר בבית החולים.

8. **טיפול בערכים חסרים**:
   עבור שדות חדשים שהוספנו, אפשרנו ערכי NULL או הגדרנו ערכי ברירת מחדל כמו 'Unknown'. זה מאפשר לנו לשמור על שלמות הנתונים תוך כדי ציון ברור של מידע חסר.

## תהליך והפקודות

בתהליך האינטגרציה נעשה שימוש בפקודות SQL למיזוג הנתונים. 
לדוגמה, איחוד טבלאות המטופלים התבצע באמצעות:
```sql
ALTER TABLE Patients
ADD Gender VARCHAR(10), 
ADD Insurance VARCHAR(50);
